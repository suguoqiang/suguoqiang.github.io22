<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="gqsu"><meta name="copyright" content="gqsu"><title>笔记 | 技术笔记分享</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?060ae9ba8fa5be868a3d10fdf6f65af4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="http://gallery.gqsu.top/favicon.png"></div><div class="author-info__name text-center">gqsu</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="http://gqsu.top" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">164</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">39</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">33</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链</div><a class="author-info-links__name text-center" href="https://xclient.info/" target="_blank" rel="noopener">mac</a><a class="author-info-links__name text-center" href="http://cron.qqe2.com/" target="_blank" rel="noopener">cron</a><a class="author-info-links__name text-center" href="https://www.bootschool.net/ascii" target="_blank" rel="noopener">banner</a><a class="author-info-links__name text-center" href="https://www.easyice.cn/" target="_blank" rel="noopener">easyice</a><a class="author-info-links__name text-center" href="http://springcloud.fun/" target="_blank" rel="noopener">springCloud-cn</a><a class="author-info-links__name text-center" href="https://greasyfork.org/zh-CN" target="_blank" rel="noopener">Greasy Fork</a><a class="author-info-links__name text-center" href="https://aotu.io/" target="_blank" rel="noopener">凹凸实验室</a><a class="author-info-links__name text-center" href="https://tgideas.qq.com/#/hot" target="_blank" rel="noopener">腾讯互娱</a><a class="author-info-links__name text-center" href="http://taobaofed.org/" target="_blank" rel="noopener">淘宝FED</a><a class="author-info-links__name text-center" href="http://fex.baidu.com/" target="_blank" rel="noopener">百度FEX</a></div></div></div><nav id="nav" style="background-image: url(http://gallery.gqsu.top/header.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">技术笔记分享</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/about">关于我</a><a class="site-page" href="/gallery">相册</a><a class="site-page" href="/slides">时光轴</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">技术笔记分享</div><div id="site-sub-title">笔记</div><div id="site-social-icons"><a class="social-icon" href="https://github.com/suguoqiang" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-github fa"></i></a><a class="social-icon" href="https://weibo.com/2498796682/profile?topnav=1&amp;wvr=6" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-weibo fa"></i></a><a class="social-icon" href="https://Molunerfinn/atom.xml" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-rss fa"></i></a><a class="social-icon" href="http://gallery.gqsu.top/wechat_me.jpg" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-weixin fa"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2018/03/15/elasticsearch-%E4%BD%BF%E7%94%A8/">ES 6.x使用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-03-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/elasticsearch/">elasticsearch</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/elasticsearch/">elasticsearch</a></span><div class="content"><p>ElasticSearch 是一个基于 Lucene 的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web 接口。<br>Elasticsearch 是用 Java 开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。<br>设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。</p>
<blockquote>
<p>6.x版本与前几个版本的区别：<a href="https://www.felayman.com/articles/2017/11/15/1510733125940.html?utm_medium=hao.caibaojian.com&utm_source=hao.caibaojian.com" target="_blank" rel="noopener">重大变化</a></p>
</blockquote>
<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>1、索引</p>
<p>索引(index)是ElasticSearch存放具体数据的地方，是一类具有相似特征的文档的集合。<br>ElasticSearch中索引的概念具有不同意思，这里的索引相当于关系数据库中的一个数据库实例<br>在ElasticSearch中索引还可以作为动词，表示对数据进行索引操作。</p>
<p>2、类型</p>
<p>索引(index)是ElasticSearch存放具体数据的地方，是一类具有相似特征的文档的集合。<br>ElasticSearch中索引的概念具有不同意思，这里的索引相当于关系数据库中的一个数据库实例。<br>在ElasticSearch中索引还可以作为动词，表示对数据进行索引操作。</p>
<p>3、文档</p>
<p>文档是ElasticSearch可被索引的基础逻辑单元，相当于关系数据库中数据表的一行数据。<br>ElasticSearch的文档具有JSON格式，由多个字段组成，字段相当于关系数据库中列的概念。</p>
<p>4、分片</p>
<p>当数据量较大时，索引的存储空间需求超出单个节点磁盘容量的限制，或者出现单个节点处理速度较慢。<br>为了解决这些问题，ElasticSearch将索引中的数据进行切分成多个分片（shard），每个分片存储这个索引的一部分数据，分布在不同节点上。<br>当需要查询索引时，ElasticSearch将查询发送到每个相关分片，之后将查询结果合并，这个过程对ElasticSearch应用来说是透明的，用户感知不到分片的存在。<br>一个索引的分片一定指定，不再修改。</p>
<p>5、副本</p>
<p>分片全称是主分片，简称为分片。主分片是相对于副本来说的，副本是对主分片的一个或多个复制版本（或称拷贝），<br>这些复制版本（拷贝）可以称为复制分片，可以直接称之为副本。<br>当主分片丢失时，集群可以将一个副本升级为新的主分片。</p></div><a class="more" href="/2018/03/15/elasticsearch-%E4%BD%BF%E7%94%A8/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/03/14/elasticsearch-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%AE%89%E8%A3%85/">ES 6.x的基本概念与安装</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-03-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/elasticsearch/">elasticsearch</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/elasticsearch/">elasticsearch</a></span><div class="content"><h3 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>ElasticSearch（简称ES）是一个分布式、Restful的搜索及分析服务器，设计用于分布式计算；能够达到实时搜索，稳定，可靠，快速。和Apache Solr一样，它也是基于Lucence的索引服务器，</p>
<p>而ElasticSearch对比Solr的优点在于：</p>
<ul>
<li>轻量级：安装启动方便，下载文件之后一条命令就可以启动。</li>
<li>Schema free：可以向服务器提交任意结构的JSON对象，Solr中使用schema.xml指定了索引结构。</li>
<li>多索引文件支持：使用不同的index参数就能创建另一个索引文件，Solr中需要另行配置。</li>
<li>分布式：Solr Cloud的配置比较复杂。</li>
</ul></div><a class="more" href="/2018/03/14/elasticsearch-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%AE%89%E8%A3%85/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/03/14/elasticsearch-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">ES-学习笔记</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-03-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/elasticsearch/">elasticsearch</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/elasticsearch/">elasticsearch</a></span><div class="content"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><ul>
<li>为什么es查询和聚合都这么快？底层是如何实现的？</li>
<li>数据在es集群中如何存储的？如何做到自动分布式的？</li>
<li>为什么es的主分片数设置了之后就不能调整，而副本分片数可以调整？</li>
<li>如何优化索引方式和查询方式，有效利用缓存，提高查询效率？</li>
<li>如果保证不停服的情况下，平滑升级或扩容？</li>
<li>如何优化查询效率？</li>
</ul>
<p>相信看完Elasticsearch权威指南这本书，所有疑问都将得到解答</p></div><a class="more" href="/2018/03/14/elasticsearch-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/03/09/springBoot-%E5%85%AC%E5%85%B1%E9%85%8D%E7%BD%AE/">springBoot公共配置</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-03-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springBoot/">springBoot</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springBoot/">springBoot</a></span><div class="content"><h3 id="Spring-Boot公共配置详细"><a href="#Spring-Boot公共配置详细" class="headerlink" title="Spring Boot公共配置详细"></a>Spring Boot公共配置详细</h3><p>最新版的请查阅: <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html" target="_blank" rel="noopener">文档</a></p>
<p>以下是1.5.x版本：</p></div><a class="more" href="/2018/03/09/springBoot-%E5%85%AC%E5%85%B1%E9%85%8D%E7%BD%AE/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/25/springBoot-%E4%BD%BF%E7%94%A8Swagger%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86/">springBoot--使用swagger统一接口文档</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-25</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springBoot/">springBoot</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springBoot/">springBoot</a></span><div class="content"><h3 id="集成swagger"><a href="#集成swagger" class="headerlink" title="集成swagger"></a>集成swagger</h3><p>1、引入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、添加配置参数（均为自定义参数）：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">swagger:</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">API标题</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">API描述</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.0</span></span><br><span class="line">  <span class="attr">terms-of-service-url:</span> <span class="string">http://gqsu.top</span></span><br><span class="line">  <span class="attr">base-package:</span> <span class="string">com.njnsi.puzzleGame.controller</span></span><br><span class="line">  <span class="attr">contact:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">gqsu</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://gqsu.top/</span></span><br><span class="line">    <span class="attr">email:</span> <span class="number">597009281</span><span class="string">@qq.com</span></span><br></pre></td></tr></table></figure>

<p>3、创建Swagger2配置类，单独新建包config包，添加配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EnableSwagger</span>2</span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(EnableSwagger2<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ConfigurationProperties</span>(<span class="title">prefix</span> </span>= <span class="string">"swagger"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Swagger2Config</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * API接口包路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String basePackage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * API页面标题</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * API描述</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务条款地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String termsOfServiceUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 版本号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 联系人</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Contact contact;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">api</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(basePackage)</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">              <span class="comment">//.securitySchemes(securitySchema())</span></span><br><span class="line">              <span class="comment">//.securityContexts(securityContext())</span></span><br><span class="line">			 <span class="comment">//.pathMapping("/");</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">apiInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(title)</span><br><span class="line">                .description(description)</span><br><span class="line">                .termsOfServiceUrl(termsOfServiceUrl)</span><br><span class="line">                .contact(contact)</span><br><span class="line">                .version(version)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">                      </span><br><span class="line">                      </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 配置默认的全局鉴权策略的开关，通过正则表达式进行匹配；默认匹配所有URL</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="comment">//private SecurityContext securityContext() &#123;</span></span><br><span class="line">	<span class="comment">//	return SecurityContext.builder()</span></span><br><span class="line">	<span class="comment">//		.securityReferences(defaultAuth())</span></span><br><span class="line">	<span class="comment">//		.forPaths(PathSelectors.regex(swaggerProperties().getAuthorization().getAuthRegex()))</span></span><br><span class="line">	<span class="comment">//		.build();</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">                      </span><br><span class="line">    <span class="comment">//private List&lt;ApiKey&gt; securitySchemes() &#123;</span></span><br><span class="line">    <span class="comment">//    List&lt;ApiKey&gt; apiKeys = new ArrayList&lt;&gt;();</span></span><br><span class="line">    <span class="comment">//    apiKeys.add(new ApiKey("Authorization", "Authorization", "header"));</span></span><br><span class="line">    <span class="comment">//    return apiKeys;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">//private List&lt;SecurityContext&gt; securityContexts() &#123;</span></span><br><span class="line">    <span class="comment">//   List&lt;SecurityContext&gt; securityContexts = new ArrayList&lt;&gt;();</span></span><br><span class="line">    <span class="comment">//    securityContexts.add(SecurityContext.builder()</span></span><br><span class="line">    <span class="comment">//            .securityReferences(defaultAuth())</span></span><br><span class="line">    <span class="comment">//            .forPaths(PathSelectors.regex("^(?!auth).*$")).build());</span></span><br><span class="line">    <span class="comment">//    return securityContexts;</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><a class="more" href="/2018/02/25/springBoot-%E4%BD%BF%E7%94%A8Swagger%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/20/springBoot-%E9%9B%86%E6%88%90SpringSecurity/">Spring Boot集成Spring Security</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springBoot/">springBoot</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springBoot/">springBoot</a></span><div class="content"><h3 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h3><p><img src="http://cdn.gqsu.top/security01-1.png" alt=""></p>
<p><img src="http://cdn.gqsu.top/security01-2.png" alt=""></p>
<h3 id="初阶-Security：-默认认证用户名密码"><a href="#初阶-Security：-默认认证用户名密码" class="headerlink" title="初阶 Security： 默认认证用户名密码"></a>初阶 Security： 默认认证用户名密码</h3><p>1、在 pom.xml 中添加spring-boot-starter-security依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>启动项目，访问网页即会出现弹出框。  </p>
<blockquote>
<p>security默认的用户名是user, 默认密码是应用启动的时候，通过UUID算法随机生成的。默认的role是”USER”</p>
</blockquote>
<p>2、当然，为了方便，可以在application.properties配置你的用户名密码，例如</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># security</span></span><br><span class="line"><span class="meta">security.user.name</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">security.user.password</span>=<span class="string">admin</span></span><br></pre></td></tr></table></figure></div><a class="more" href="/2018/02/20/springBoot-%E9%9B%86%E6%88%90SpringSecurity/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/20/springBoot-%E9%9B%86%E6%88%90redisson%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">Spring Boot集成Spring Security</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springBoot/">springBoot</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springBoot/">springBoot</a></span><div class="content"><h3 id="Redisson分布式锁"><a href="#Redisson分布式锁" class="headerlink" title="Redisson分布式锁"></a>Redisson分布式锁</h3><p>1、添加依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.redisson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>2、定义Lock接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> org.redisson.api.RLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DistributedLocker</span> </span>&#123;</span><br><span class="line">    <span class="function">RLock <span class="title">lock</span><span class="params">(String lockKey)</span></span>;</span><br><span class="line">    <span class="function">RLock <span class="title">lock</span><span class="params">(String lockKey, <span class="keyword">int</span> timeout)</span></span>;</span><br><span class="line">    <span class="function">RLock <span class="title">lock</span><span class="params">(String lockKey, TimeUnit unit, <span class="keyword">int</span> timeout)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">(String lockKey, TimeUnit unit, <span class="keyword">int</span> waitTime, <span class="keyword">int</span> leaseTime)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">(String lockKey)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">unlock</span><span class="params">(RLock lock)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><a class="more" href="/2018/02/20/springBoot-%E9%9B%86%E6%88%90redisson%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/13/springBoot-%E6%89%93%E5%8C%85%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">springBoot-打包部署与性能优化</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-13</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springBoot/">springBoot</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springBoot/">springBoot</a></span><div class="content"><h3 id="打包部署"><a href="#打包部署" class="headerlink" title="打包部署"></a>打包部署</h3><blockquote>
<p>两种方式：一种是打包成 jar 包直接执行，另一种是打包成 war 包放到 tomcat 服务器下</p>
</blockquote>
<blockquote>
<p>特别指出一点，bootstrap.yml 和 application.yml 不一样，bootstarp 会先加载进工程里，尤其体现在统一配置config 里面。</p>
</blockquote>
<blockquote>
<p>如果同一个目录下，有application.yml也有application.properties，默认先读取application.properties。还有就是加载文件的顺序会覆盖。</p>
</blockquote>
<h4 id="打成jar包"><a href="#打成jar包" class="headerlink" title="打成jar包"></a>打成jar包</h4><h5 id="1、方式一，采用-maven-管理"><a href="#1、方式一，采用-maven-管理" class="headerlink" title="1、方式一，采用 maven 管理"></a>1、方式一，采用 maven 管理</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> cd 项目根目录（和pom.xml同级）</span><br><span class="line"><span class="variable">$</span> mvn clean package</span><br><span class="line"><span class="comment">## 或者执行下面的命令,排除测试代码后进行打包,即不进行测试</span></span><br><span class="line"><span class="variable">$</span> mvn clean package  <span class="literal">-Dmaven</span>.test.skip=true</span><br><span class="line"><span class="comment">## 不执行测试用例，但编译测试用例类生成相应的class文件至target/test-classes下。</span></span><br><span class="line"><span class="variable">$</span> mvn package <span class="literal">-DskipTests</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>排除测试代码打包，还可以将<code>@SpringBootTest</code>等注释掉。</p>
</blockquote>
<p>打包完成后jar包会生成到target目录下，命名一般是 项目名+版本号.jar </p></div><a class="more" href="/2018/02/13/springBoot-%E6%89%93%E5%8C%85%E9%83%A8%E7%BD%B2%E4%B8%8E%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/09/springDataJpa-%E5%AD%A6%E4%B9%A0/">springDataJpa学习</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/springDataJpa/">springDataJpa</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/springDataJpa/">springDataJpa</a></span><div class="content"><blockquote>
<p>orm框架的本质是简化编程中操作数据库的编码，发展到现在基本上就剩两家了，<br>一个是宣称可以不用写一句SQL的hibernate，一个是可以灵活调试动态sql的mybatis.  </p>
</blockquote>
<blockquote>
<p>hibernate特点就是所有的sql都用Java代码来生成，不用跳出程序去写（看）sql，有着编程的完整性，<br>发展到最顶端就是spring data jpa这种模式了</p>
</blockquote>
<h3 id="基本操作实现（默认方法）"><a href="#基本操作实现（默认方法）" class="headerlink" title="基本操作实现（默认方法）"></a>基本操作实现（默认方法）</h3><p>1、继承JpaRepository</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、使用默认方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBaseQuery</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	User user=<span class="keyword">new</span> User();</span><br><span class="line">	userRepository.findAll();</span><br><span class="line">	userRepository.findOne(<span class="number">1l</span>);</span><br><span class="line">	userRepository.save(user);</span><br><span class="line">	userRepository.delete(user);</span><br><span class="line">	userRepository.count();</span><br><span class="line">	userRepository.exists(<span class="number">1l</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><a class="more" href="/2018/02/09/springDataJpa-%E5%AD%A6%E4%B9%A0/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/02/09/git-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">Git的基本使用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-02-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/git/">git</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/git/">git</a></span><div class="content"><p>git中最重要的四个点：工作区、暂存区、本地仓库和远程仓库</p>
<p>工作区—(git add)—-&gt;暂存区—-(git commit)—-&gt;  本地仓库 —–(git push)—-&gt;  远程仓库 </p>
<h3 id="git基本操作"><a href="#git基本操作" class="headerlink" title="git基本操作"></a>git基本操作</h3><ul>
<li><code>$ git init</code>： 初始化一个Git仓库</li>
<li><code>$ git remote add origin https://github.com/suguoqiang/hexo.git</code>：添加一个origin变量代替url地址</li>
<li><code>$ git add &lt;file&gt;</code>： 添加文件到暂存区，可反复使用。<code>.</code>代表当前路径下所有文件</li>
<li><code>$ git commit -m &lt;message&gt;</code>：提交到树形分支</li>
<li><code>$ git status</code>：查看当前仓库状态</li>
<li><code>$ git diff &lt;file&gt;</code>：查看文件异同，如：<code>git diff HEAD -- readme.txt</code></li>
<li><code>$ git log</code>：查看最近到最远的提交日志。可选简化的参数：<code>--pretty=oneline</code></li>
<li><code>$ git rm &lt;file&gt;</code>: 删除版本库中的某一个文件</li>
<li><code>$ git remote -v</code> ：详细远程库的信息</li>
</ul></div><a class="more" href="/2018/02/09/git-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/#more">阅读更多</a><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(http://gallery.gqsu.top/header.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By gqsu</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="footer_custom_text">聚合优质内容，捕捉每个瞬间，细品生活滋味,体会百味人生. 小小的站有大大的梦!</div><div class="icp"><a href="http://www.beian.miit.gov.cn/" target="_blank" rel="noopener"><span>苏ICP备19072098号</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>